<style>
    .footer-copyright{
        display: none;;
    }
    label{
        width:120px;
    }
    input:focus-visible {
        outline: none;
    }
    .noinput{
        background: #cbcbcb;
    }
    table.dataTable thead .sorting:after,
    table.dataTable thead .sorting:before,
    table.dataTable thead .sorting_asc:after,
    table.dataTable thead .sorting_asc:before,
    table.dataTable thead .sorting_asc_disabled:after,
    table.dataTable thead .sorting_asc_disabled:before,
    table.dataTable thead .sorting_desc:after,
    table.dataTable thead .sorting_desc:before,
    table.dataTable thead .sorting_desc_disabled:after,
    table.dataTable thead .sorting_desc_disabled:before {
    bottom: .5em;
    }
    .paginate_button , .next,  .current,  .previous {
        padding: 0 0.2rem 0 0.2rem ;
        background: #9b9b9b;
        border: 1px solid grey;
        cursor: pointer;
    }
 
</style>
{#
{% for product in productlist %}
<div class="name" style="">
    {{ product.item_name }}<br>
</div>


<div class="name" style="">
    {{ product.name }}<br>
</div>
<div class="name" style="">
    {{ product.item_code }}<br>
</div>
<div>
    Price: {{ product.formatted_price or 'N/A' }}<br>
</div>
{% endfor %}
#}
<div class="slaes-order mt-4 mr-4 ml-4">
    <div class="">
        <table>
            <tbody>
                <tr>
                    <td class="pr-4">
                        <label for="sales_order_id" class="">Order ID</label>
                        <input type="text" id="sales_order_id">
                    </td>
                    <td>
                        <label for="date" class="">Date</label>
                        <input type="date" id="date">
                    </td>
                </tr>
                <tr>
                    <td class="pr-4">
                        <label for="customer" class="">Customer</label>
                        <input type="text" class="noinput" id="customer" readonly>
                        <span id="customer_modal_span" data-toggle="modal" data-target="#customer_modal"> 
                            <svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" data-name="Layer 1" viewBox="0 0 64 64"><circle cx="22.01" cy="22" r="20.02" fill="none" stroke="#010101" stroke-miterlimit="10" stroke-width="4"/><path fill="none" stroke="#010101" stroke-miterlimit="10" stroke-width="4" d="M35.94,36Q49,49,62,62"/></svg>
                        </span>
                        <div class="modal fade" id="customer_modal" tabindex="-1" role="dialog" aria-labelledby="customer_modalLabel" aria-hidden="true">
                            <div class="modal-dialog" role="document">
                              <div class="modal-content">
                                <div class="modal-header">
                                  <h5 class="modal-title" id="customer_modalLabel">Customer Search Dialog</h5>
                                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                  </button>
                                </div>
                                <div class="modal-body">
                                    <table id="customerTable" class="table table-striped table-bordered table-sm" cellspacing="0" width="100%">
                                        <thead>
                                          <tr>
                                            <th class="th-sm">Code
                                            </th>
                                            <th class="th-sm">Customer
                                            </th>

                                          </tr>
                                        </thead>
                                        <tbody id="table1">
                                        {% for customer in customers %}
                                          <tr class="customersvalues">
                                            <td>{{customer.customer_group}}</td>
                                            <td class="customername">{{customer.customer_name}}</td>
                                          </tr>
                                        {% endfor %}
                                        </tbody>
  
                                      </table>
                                </div>
                              </div>
                            </div>
                          </div>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
    <div class="">
        <table id="productsTable" class="table table-striped table-bordered table-sm text-center" cellspacing="0" width="100%">
            <thead>
              <tr>
                <th style="width: 40%;" class="th-sm">Product</th>
                <th style="width: 20%;"  class="th-sm">Qty</th>
                <th style="width: 20%;" class="th-sm">Rate</th>
                <th style="width: 20%;" class="th-sm">Amount</th>

              </tr>
            </thead>
            <tbody id="table3">
                <tr class="productsvalues">
                    <td><span class="productspan" onclick="getspanindex(this);" data-toggle="modal" >
                        <svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" data-name="Layer 1" viewBox="0 0 64 64"><line x1="1.49" x2="27.81" y1="62.45" y2="36.13" fill="none" stroke="#010101" stroke-miterlimit="10" stroke-width="4"/><circle cx="42.22" cy="21.85" r="20.3" fill="none" stroke="#010101" stroke-miterlimit="10" stroke-width="4"/></svg>
                    </span>
                    <input type="text" class="productss hidden" readonly >
                </td>
                    
                    
                    <td class="quantity1"><input type="number" class="quantity"  name="quantity" value=0  oninput="calc();"></td>
                    <td  class="rate1"><input type="number" class="rate"  step="0.01" value=0.00  oninput="calc();"></td>
                    <td  class="totalAmt1"><input type="number" class="totalAmt noinput" value=0.00  onchange="calcNetTotal();" readonly></td>
                </tr>
                <tr class="productsvalues">
                    <td><span class="productspan" onclick="getspanindex(this);" data-toggle="modal" ><svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" data-name="Layer 1" viewBox="0 0 64 64"><line x1="1.49" x2="27.81" y1="62.45" y2="36.13" fill="none" stroke="#010101" stroke-miterlimit="10" stroke-width="4"/><circle cx="42.22" cy="21.85" r="20.3" fill="none" stroke="#010101" stroke-miterlimit="10" stroke-width="4"/></svg></span>
                        <input type="text" class="productss hidden" readonly ></td>
                    <td class="quantity1"><input type="number" class="quantity"  name="quantity" value=0  oninput="calc();"></td>
                    <td class="rate1"><input type="number" class="rate"  step="0.01" value=0.00   oninput="calc();"></td>
                    <td class="totalAmt1"><input type="number" class="totalAmt noinput" value=0.00   onchange="calcNetTotal();" readonly></td>
                </tr>
            </tbody>
          </table>
          <div class="modal text-left fade" id="product_modal" tabindex="-1" role="dialog" aria-labelledby="customer_modalLabel" aria-hidden="true">
            <div class="modal-dialog" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title" id="product_modalLabel">Products Search Dialog</h5>
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                  </button>
                </div>
                <div class="modal-body">
                    <table id="productTable" class="table table-striped table-bordered table-sm" cellspacing="0" width="100%">
                        <thead>
                          <tr>
                            <th class="th-sm">Code
                            </th>
                            <th class="th-sm">Product
                            </th>

                          </tr>
                        </thead>
                        <tbody id="table2">

                          <tr class="productsvalues">
                            <td>1</td>
                            <td class="productname">Keyboard</td>
                          </tr>
                          <tr class="productsvalues">
                            <td>2</td>
                            <td class="productname">Mouse</td>
                          </tr>

                        </tbody>

                      </table>
                </div>
              </div>
            </div>
          </div>
          <div class="">
              <div class="d-flex flex-row justify-content-between">
                <div class=""><button onclick="addRow();" id="addproduct">Add Product</button></div>
                <div class="">
                    <label for="netAmount">Net Amount:</label>
                    <input type="number" class="netAmount noinput" id="netAmount" value=0.00 readonly>
                </div>
              </div>
              <div class="d-flex flex-row justify-content-end">
                <button onclick="emptyTable();">Cancel</button>
                <button onclick="saveTable();">Save</button>
              </div>
          </div>
          <script>
            function getspanindex(el){

                console.log( $('.productspan').index(el) );
                var d = $('.productspan').index(el);
                
                $('#indexvalueforproducts').html( $('.productspan').index(el) );
                $('#product_modal').modal('show');
            }
            function emptyTable(){
                $("#table3").html("");
                $("#addproduct").prop("disabled", false);
                $("#netAmount").val("");
                $('input').prop("disabled", false);
                $("#customer_modal_span").css('display','inline-block');
                $(".productspan").css('display','inline-block');
            };
            function saveTable(){
                $("#addproduct").prop("disabled", true);
                $('input').prop("disabled", true);
                $("#customer_modal_span").css('display','none');
                $(".productspan").css('display','none');

                
            };
            function calc() {
                $('#table3 .productsvalues').each(function() {
                    var quantity = $(this).children(".quantity1").children(".quantity").val();
                    var quantity1 = parseInt(quantity) || 0;
                    var rate = $( this ).children(".rate1").children(".rate").val();
                    var rate1 = parseFloat(rate) || 0;
                    var total = parseFloat(quantity1 * rate1).toFixed(2) ;
                    $( this ).children(".totalAmt1").children(".totalAmt").val(total).change() ;
                });
            };
            function calcNetTotal(){
                var va = 0;
                $('.totalAmt').each(function() {
                    va = va+ parseFloat($( this ).val()) ;
                });
                var r =va.toFixed(2);
                $("#netAmount").val(r);
            }; 
            function addRow(){
                $("#table3").append(`
                <tr class="productsvalues">
                    <td><span class="productspan" onclick="getspanindex(this);" data-toggle="modal" ><svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" data-name="Layer 1" viewBox="0 0 64 64"><line x1="1.49" x2="27.81" y1="62.45" y2="36.13" fill="none" stroke="#010101" stroke-miterlimit="10" stroke-width="4"/><circle cx="42.22" cy="21.85" r="20.3" fill="none" stroke="#010101" stroke-miterlimit="10" stroke-width="4"/></svg></span>
                        <input type="text" class="productss hidden" readonly ></td>
                    <td class="quantity1"><input type="number" class="quantity"  name="quantity" value=0  oninput="calc();"></td>
                    <td  class="rate1"><input type="number" class="rate"  step="0.01" value=0.00  oninput="calc();"></td>
                    <td  class="totalAmt1"><input type="number" class="totalAmt noinput" value=0.00  onchange="calcNetTotal();" readonly></td>
                </tr>
                `);
            };

        </script>
        
    </div>
    <div class=""></div>
</div>
<div id="indexvalueforproducts" style="display:none;"></div>
<script src="https://cdn.datatables.net/1.10.23/js/jquery.dataTables.min.js" defer></script>